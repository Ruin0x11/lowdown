row = ['County','Provider']
for purpose in @trip_purposes
  row << purpose.gsub(/([\/-])/,' \1 ')
end
csv << row

@results.keys.sort.each do |county|
  @results[county].keys.sort_by{|provider| provider.try(:name) || "Unspecified" }.each do |provider|
    row = [county,(provider.try(:name) || 'Unspecified')]
    for purpose in @trip_purposes 
      row << number_with_delimiter(@results[county][provider].by_purpose[purpose])
    end 
    csv << row
  end
end
