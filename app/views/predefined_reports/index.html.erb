<% content_for :head do -%>
  <%= javascript_tag do -%>
    $(document).ready(function(){
      $('.predefined-report fieldset').css('clear', 'none');
      $('.predefined-report').css('margin-left', '235px');

      var $menu = $('<ul id="reports-menu">');
      $menu.css({
        'float':      'left',
        'list-style': 'none',
        'margin':     '0',
        'padding':    '0',
        'width':      '215px'
      });
      $('#page-header').after($menu);
      
      var $reports = $('.predefined-report h2').sort(function(a, b){return $(a).text().toLowerCase() > $(b).text().toLowerCase() ? 1 : -1;});
      $reports.each(function(){
        $li = $('<li>');
        $a = $('<a>');
        $a.text($(this).text());
        $a.data('target', $(this).closest('.predefined-report'));
        $li.append($a)
        $menu.append($li);
        $a.click(function(){
          $this = $(this);
          $('.predefined-report:visible').hide();
          $('#reports-menu li').css('background-color', '#eee');
          $this.closest('li').css('background-color', '#ccc');
          $this.data('target').fadeIn('fast');
        });
      });
      
      $menu.find('li a').css({
        'color':       '#000 !important',
        'cursor':      'pointer',
        'display':     'block',
        'font-weight': 'bold'
      });

      $menu.find('li').css({
        '-moz-border-radius':    '5px',
        '-webkit-border-radius': '5px',
        'background-color':      '#eee',
        'border':                '1px solid #bbb',
        'border-radius':         '5px',
        'margin':                '4px 0',
        'padding':               '5px'
      });
      
      $('.predefined-report').hide();
      $menu.before('<h2>Available Reports:</h2>');
      $menu.find('li:first').css('background-color', '#ccc').find('a').click();
    });
  <% end -%>
<% end -%>

<div id="page-header">
  <h1>Predefined Reports</h1>
</div>

<div class="predefined-report" data-name="monthly" id="basic_report">
  <%= form_for @query, :html => { :class => "run-report"}, :url => { :action => :spd_report } do |f| %>
    <fieldset>
      <h2 class="report-header">SPD Report</h2>
      <p></p>
      <ol>
        <li>
          <label>Start date:</label>
          <%= f.text_field :start_date, :class => "datepicker", :placeholder => "yyyy-mm-dd", :required => :required %>
        </li>
        <li>
          <label>End date:</label>
          <%= f.text_field :end_date, :class => "datepicker", :placeholder => "yyyy-mm-dd", :required => :required %>
        </li>
      </ol>
      <input type="submit" name="report" value="Report">
    </fieldset>
  <% end %>
</div>


